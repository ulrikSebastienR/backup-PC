#https://www.postgresql.org/docs/9.1/plpython-funcs.html

#check maximum integer
CREATE FUNCTION pymax(a integer, b integer)
    RETURNS integer
AS $$
    if a>b:
        return a
    return b
$$ LANGUAGE plpythonu;
    
# check if overpaid https://www.postgresql.org/docs/9.1/plpython-data.html
CREATE TABLE employee(
    name VARCHAR, 
    age INT,
    salary INT,
);

CREATE FUNCTION overpaid(e employee)
    RETURNS boolean
AS $$
if e["salary"] > 200000:
    return True
if (e["salary"] > 100000 and e["age"] < 30):
    return True
return False
$$ LANGUAGE plpythonu

